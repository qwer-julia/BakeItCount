@page
@model VoteModel

<div class="mx-auto my-10 flex gap-2 text-cocoa">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="size-10 mt-2">
        <path d="m15 1.784-.796.795a1.125 1.125 0 1 0 1.591 0L15 1.784ZM12 1.784l-.796.795a1.125 1.125 0 1 0 1.591 0L12 1.784ZM9 1.784l-.796.795a1.125 1.125 0 1 0 1.591 0L9 1.784ZM9.75 7.547c.498-.021.998-.035 1.5-.042V6.75a.75.75 0 0 1 1.5 0v.755c.502.007 1.002.021 1.5.042V6.75a.75.75 0 0 1 1.5 0v.88l.307.022c1.55.117 2.693 1.427 2.693 2.946v1.018a62.182 62.182 0 0 0-13.5 0v-1.018c0-1.519 1.143-2.829 2.693-2.946l.307-.022v-.88a.75.75 0 0 1 1.5 0v.797ZM12 12.75c-2.472 0-4.9.184-7.274.54-1.454.217-2.476 1.482-2.476 2.916v.384a4.104 4.104 0 0 1 2.585.364 2.605 2.605 0 0 0 2.33 0 4.104 4.104 0 0 1 3.67 0 2.605 2.605 0 0 0 2.33 0 4.104 4.104 0 0 1 3.67 0 2.605 2.605 0 0 0 2.33 0 4.104 4.104 0 0 1 2.585-.364v-.384c0-1.434-1.022-2.7-2.476-2.917A49.138 49.138 0 0 0 12 12.75ZM21.75 18.131a2.604 2.604 0 0 0-1.915.165 4.104 4.104 0 0 1-3.67 0 2.605 2.605 0 0 0-2.33 0 4.104 4.104 0 0 1-3.67 0 2.605 2.605 0 0 0-2.33 0 4.104 4.104 0 0 1-3.67 0 2.604 2.604 0 0 0-1.915-.165v2.494c0 1.035.84 1.875 1.875 1.875h15.75c1.035 0 1.875-.84 1.875-1.875v-2.494Z" />
    </svg>


    <h1 class="font-bungeeInline text-6xl text-left "> Vote no seu sabor favorito </h1>
</div>

@if (TempData["Message"] != null)
{
    <div class="bg-green-100 text-green-700 px-4 py-2 rounded mb-4">
        @TempData["Message"]
    </div>
}

@if (!ViewData.ModelState.IsValid)
{
    <div class="bg-red-100 text-red-700 px-4 py-2 rounded mb-4">
        @Html.ValidationSummary()
    </div>
}

<form method="post" class="space-y-6">
    <!-- UserId vem do backend -->
    <input type="hidden" name="UserId" value="@Model.UserId" />

    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
        @foreach (var flavor in Model.Flavors)
        {
            <div class="rounded-2xl p-4 border-3 border-cocoa">
                <label class="flex items-center space-x-2 cursor-pointer font-bungee text-2xl text-cocoa gap-4">
                    <input type="checkbox"
                           name="SelectedFlavors"
                           value="@flavor.FlavorId"
                           class="flavor-checkbox w-5 h-5 text-blue-600 rounded border-gray-300" />
                    <span >
                        <strong>@flavor.Name</strong><br />
                        <small class="text-gray-600 text-peach">@flavor.Description</small>
                    </span>
                </label>
            </div>
        }
    </div>

    <div class="my-20 mx-auto text-center">
        <button type="submit"
                class="bg-mint text-beige rounded-2xl font-bungee px-4 py-2 text-4xl mx-2
                  hover:bg-mint-light hover:text-beige cursor-pointer">
            ENVIAR
        </button>
    </div>
</form>

@section Scripts {
    <script>
        document.querySelectorAll(".flavor-checkbox").forEach(cb => {
            cb.addEventListener("change", () => {
                const checked = document.querySelectorAll(".flavor-checkbox:checked");
                if (checked.length > 2) {
                    cb.checked = false;
                    alert("⚠️ Você pode escolher no máximo 2 sabores.");
                }
            });
        });
    </script>
}
